# Design Plan（详细设计方案）

## 1. 成长任务与验证链路

- 设计原则：积分发放必须依赖真实业务行为。
- 交互策略：
  - `daily-signin` 保留任务页完成（低风险动作）；
  - `publish-adopt-request`、`engage-rescue` 改为“去完成”，跳转业务页。
- 视觉策略：任务卡保持进度可视化，但对可跳转任务突出状态词（去完成/已完成）。

## 2. 公益捐赠详情流

- 入口：成长任务页 -> 捐赠详情页。
- 页面结构：
  1) 项目概览（机构名、影响描述、积分门槛、当前积分）
  2) 捐赠方式说明（至少 2 种）
  3) 留言板（120 字）
  4) 反馈建议入口（跳转 `feedback`）
  5) 提交按钮（含余额校验）
- 数据策略：继续写入 `donate_points` RPC，备注入库 note。

## 3. 消息中心批量操作

- 编辑模式底栏布局：全选 + 标记已读 + 删除。
- 行为规则：
  - 标记已读执行后退出编辑模式并 Toast 成功数；
  - 删除保留原流程。

## 4. 聊天附件面板

- 点击动作最小可用：
  - 拍照：触发 `capture` 输入；
  - 相册：触发图片选择；
  - 文件：触发文件选择；
  - 位置：插入位置占位文本。
- 反馈：每个动作要有可感知结果（文本占位或提示）。

## 5. 认证与资料页视觉升级

- 认证页：统一 dark mode 变量体系，避免亮底突兀。
- 资料编辑弹层：
  - 顶部拖拽条 + 强化头像区；
  - 表单按“可编辑/只读”分组卡片；
  - 底部粘性操作区（取消/保存）。

## 6. 智能体扩容

- 数据源：统一由 `lib/config/aiAgents.ts` 配置驱动。
- 新增智能体：
  - 领养顾问
  - 行为训练师
  - 医疗问诊助手
  - 营养喂养师
  - 救助协调员
  - 新手陪伴教练
- UI：消息页顶部入口与新建会话 Sheet 共用同一配置渲染。

## 7. 周期评分报告（MVP）

- 目标对象：有领养申请/领养记录用户。
- 触发机制：进入消息页时检查上次推送时间，超过 10 天即生成并写入系统会话。
- 去重：`localStorage` 按 userId 存储最后推送时间戳。
- 后续演进：升级至 Supabase Cron + Edge Function 统一调度。
